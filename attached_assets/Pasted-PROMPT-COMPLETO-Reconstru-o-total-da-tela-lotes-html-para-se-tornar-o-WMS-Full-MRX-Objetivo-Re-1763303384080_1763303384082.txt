PROMPT COMPLETO â€” ReconstruÃ§Ã£o total da tela /lotes.html para se tornar o WMS Full MRX

Objetivo:
Reformular completamente a tela /lotes.html para transformÃ¡-la no WMS (Warehouse Management System) central da MRX, atendendo 100% dos requisitos definidos no arquivo MRX_GestÃ£o.md, incluindo:

Entrada de estoque

MovimentaÃ§Ãµes internas

LocalizaÃ§Ãµes

HistÃ³rico por lote

Reservas

Bloqueios (QC/InventÃ¡rio)

Sublotes (SeparaÃ§Ã£o)

DivergÃªncias

Auditoria

IntegraÃ§Ã£o com conferÃªncia e separaÃ§Ã£o

InventÃ¡rio (3 contagens)

VisualizaÃ§Ãµes operacionais e gerenciais

PermissÃµes por perfil

A nova tela deve substituir completamente a interface atual e organizar todo o fluxo de estoque da MRX.

ğŸŸ¦ 1. REFORMULAÃ‡ÃƒO TOTAL DA INTERFACE /lotes.html

A tela deve ser reestruturada em 5 grandes seÃ§Ãµes, todas acessÃ­veis via tabs ou cards superiores:

TAB 1 â€” â€œVisÃ£o Geral do Estoque (WMS Overview)â€
Elementos obrigatÃ³rios:

Cards com mÃ©tricas:

Total de lotes ativos

Total em kg

Lotes bloqueados

Lotes divergentes

Lotes aguardando separaÃ§Ã£o

Lotes reservados

Lotes em inventÃ¡rio

GrÃ¡fico por tipo de material

GrÃ¡fico por localizaÃ§Ã£o

Linha do tempo das Ãºltimas 20 movimentaÃ§Ãµes

Filtros:

Material

Fornecedor

Status

LocalizaÃ§Ã£o

DivergÃªncia

Data da conferÃªncia

TAB 2 â€” â€œLotes Ativosâ€ (principal)
Tabela deve ter:

NÃºmero do lote (YYYY-XXXXX)

Material

Peso lÃ­quido

Fornecedor

Origem (SC/OC/OS)

Status (cores)

LocalizaÃ§Ã£o atual

Indicador de divergÃªncia

Indicador de bloqueio

Data de criaÃ§Ã£o

AÃ§Ãµes

Status obrigatÃ³rios:

EM_ESTOQUE

BLOQUEADO_QC

BLOQUEADO_INVENTARIO

AGUARDANDO_SEPARACAO

EM_SEPARACAO

PROCESSADO

DIVERGENTE_AGUARDANDO_ADM

ENCERRADO

AÃ§Ãµes por lote:

Ver detalhes

Mover lote (WMS movimentaÃ§Ã£o)

Reservar

Liberar reserva

Enviar para separaÃ§Ã£o

Bloquear lote (QC) (ADM)

Desbloquear QC (ADM)

Bloquear para inventÃ¡rio (ADM)

Desbloquear inventÃ¡rio (ADM)

Executar ajuste de estoque (ADM)

HistÃ³rico completo do lote

Regras de permissÃ£o:

Conferente â†’ apenas visualizar

SeparaÃ§Ã£o â†’ apenas lotes prÃ³prios

Estoque â†’ movimentar/transferir

ADM â†’ tudo, incluindo ajustes e bloqueios

TAB 3 â€” â€œMovimentaÃ§Ãµes WMSâ€
Tabela com:

lote_id

movimento_id

tipo (entrada / transferÃªncia / separaÃ§Ã£o / ajuste / reserva / desbloqueio / inventÃ¡rio / cancelamento)

origem

destino

quantidade

responsÃ¡vel

motivo

data/hora

GPS

IP

botÃ£o â€œver antes/depoisâ€

FunÃ§Ãµes obrigatÃ³rias:

TransferÃªncia entre endereÃ§os

MovimentaÃ§Ã£o parcial (ex.: mover sÃ³ parte do lote)

ReversÃ£o de movimentaÃ§Ã£o

Registrar motivo obrigatÃ³rio

ProteÃ§Ã£o contra movimentar lote bloqueado

EndereÃ§os prÃ©-configurados:

RECEBIMENTO

DOCK 1

DOCK 2

SEPARAÃ‡ÃƒO

PICKING

BULK

INVENTARIO

QC

TAB 4 â€” â€œDetalhes do Loteâ€ (visualizaÃ§Ã£o completa)

Ao clicar em qualquer lote:

SeÃ§Ãµes obrigatÃ³rias:

CabeÃ§alho com:

lote_id

material

origem SC â†’ OC â†’ OS

fornecedor

conferÃªncia (peso/qualidade e fotos)

Status atual + indicadores

LocalizaÃ§Ã£o atual

ComposiÃ§Ã£o (se possui sublotes)

DivergÃªncias detectadas na conferÃªncia

Sublotes criados na separaÃ§Ã£o

ResÃ­duos gerados

HistÃ³rico completo (timeline) do lote

Auditoria completa das alteraÃ§Ãµes

before / after

user

gps / ip

timestamp

AÃ§Ãµes

movimentar

reservar

bloquear/desbloquear

enviar para separaÃ§Ã£o

ajuste de estoque (ADM)

TAB 5 â€” â€œInventÃ¡rioâ€
Funcionalidades exigidas:

Gerar inventÃ¡rio de local ou geral

TrÃªs contagens independentes (1Âª, 2Âª e 3Âª)

Lista cega (nÃ£o mostrar quantidade atual)

Bloqueio automÃ¡tico de movimentaÃ§Ãµes enquanto inventÃ¡rio estiver ativo

ConsolidaÃ§Ã£o automÃ¡tica das diferenÃ§as

DivergÃªncias â†’ ADM precisa aprovar antes de ajustar

Auditoria de inventÃ¡rio

Tabela inclui:

lote_id

material

localizaÃ§Ã£o

quantidades da 1Âª, 2Âª e 3Âª contagem

status

diferenÃ§a consolidada

quem realizou cada contagem

aÃ§Ãµes

ğŸŸ¥ 2. NOVOS ENDPOINTS NECESSÃRIOS (BACKEND)
Lotes

GET /lotes

GET /lotes/{id}

PATCH /lotes/{id}/status

PATCH /lotes/{id}/bloquear

PATCH /lotes/{id}/desbloquear

MovimentaÃ§Ãµes

POST /lotes/{id}/movimentar

POST /lotes/{id}/reservar

POST /lotes/{id}/liberar-reserva

POST /movimentacoes/{id}/reverter

InventÃ¡rio

POST /inventario/iniciar

POST /inventario/{id}/contagem

POST /inventario/{id}/finalizar

POST /inventario/{id}/consolidar

SeparaÃ§Ã£o (integraÃ§Ã£o)

POST /separacao/{id}/iniciar

POST /separacao/{id}/finalizar

POST /separacao/{id}/sublotes

POST /separacao/{id}/residuos

Auditoria

GET /auditoria/lotes/{id}

ğŸŸ© 3. LÃ“GICA QUE DEVE SER IMPLEMENTADA
âœ” Entrada automÃ¡tica em estoque apÃ³s conferÃªncia
âœ” MovimentaÃ§Ãµes sÃ³ possÃ­veis se lote nÃ£o estiver bloqueado
âœ” Auditoria completa (before/after, gps, ip)
âœ” Reserva impede separaÃ§Ã£o e saÃ­da
âœ” InventÃ¡rio bloqueia movimentaÃ§Ãµes
âœ” FIFO/FEFO sugeridos automaticamente
âœ” Sublotes herdam custo e origem do lote pai
âœ” DivergÃªncias exigem aprovaÃ§Ã£o ADM
ğŸŸ¦ 4. DESIGN/UI ESTILO
Deve incluir:

cores por status

Ã­cones intuitivos

modal para detalhes

filtros avanÃ§ados

tooltips explicativos

tabelas ordenÃ¡veis

UI leve e responsiva

experiÃªncia profissional tipo ERP

ğŸŸ§ 5. CRITÃ‰RIOS DE ACEITE (QUALIDADE/TESTES)

Conseguir criar lote e visualizar na tela

Transferir lote e ver histÃ³rico completo

Bloquear e desbloquear lote corretamente

Criar inventÃ¡rio e bloquear movimentaÃ§Ãµes

Finalizar inventÃ¡rio com consolidaÃ§Ã£o

Criar sublotes e aparecerem na Ã¡rvore de composiÃ§Ã£o

A tela /lotes.html substituir completamente o modelo antigo

ğŸŸ© Entrega esperada

Ao final deste prompt, o sistema deve ter:

âœ” um WMS completo
âœ” controles de estoque reais
âœ” movimentaÃ§Ãµes com auditoria
âœ” inventÃ¡rio funcional
âœ” integraÃ§Ã£o com separaÃ§Ã£o
âœ” UI profissional e clara
âœ” tudo alinhado ao MRX_GestÃ£o.md