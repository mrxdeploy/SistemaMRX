PROMPT COMPLETO PARA O AGENT - M√ìDULO COMPRADOR MRX
üéØ OBJETIVO GERAL
Implementar o M√≥dulo Comprador completo do sistema MRX, seguindo o fluxo descrito no documento "Vis√£o geral do M√≥dulo Comprador", com foco especial em:

Sistema de tabelas de pre√ßo por estrelas (1‚òÖ, 2‚òÖ, 3‚òÖ)
Gest√£o de produtos/materiais por tipo e classifica√ß√£o
Importa√ß√£o em massa via Excel
Reformula√ß√£o da interface de tipos de lote
üì¶ ETAPA 1: REESTRUTURA√á√ÉO DO MODELO DE DADOS
1.1 Criar Tabela de Materiais/Produtos Base
Objetivo: Criar uma tabela central que armazena TODOS os tipos de materiais que podem ser comprados (baseado na lista fornecida: SUCATA PROCESSADOR CER√ÇMICO A, SUCATA PLACA M√ÉESERVIDOR, etc.)

Estrutura da tabela materiais_base:

id (PK)
codigo (√∫nico, ex: "MAT001", "MAT002")
nome (ex: "SUCATA PROCESSADOR CER√ÇMICO A")
classificacao (ENUM: 'leve', 'medio', 'pesado')
descricao (texto)
ativo (boolean)
data_cadastro
data_atualizacao
Regras:

Cada material tem UMA classifica√ß√£o fixa (leve/m√©dio/pesado)
O c√≥digo √© gerado automaticamente: MAT001, MAT002, etc.
Limite de 500 materiais cadastrados
1.2 Criar Sistema de Tabelas de Pre√ßo por Estrelas
Objetivo: Criar 3 tabelas de pre√ßo diferentes (1‚òÖ, 2‚òÖ, 3‚òÖ), cada uma com pre√ßos para TODOS os materiais cadastrados.

Estrutura da tabela tabelas_preco:

id (PK)
nome (ex: "Tabela 1 Estrela", "Tabela 2 Estrelas", "Tabela 3 Estrelas")
nivel_estrelas (1, 2 ou 3)
ativo (boolean)
data_criacao
Estrutura da tabela tabela_preco_itens:

id (PK)
tabela_preco_id (FK ‚Üí tabelas_preco)
material_id (FK ‚Üí materiais_base)
preco_por_kg (DECIMAL 10,2)
ativo (boolean)
data_atualizacao
CONSTRAINT UNIQUE: (tabela_preco_id, material_id)
Regras:

Quando um novo material √© cadastrado, ele DEVE ter pre√ßos cadastrados nas 3 tabelas
Apenas ADM pode editar pre√ßos
Hist√≥rico de altera√ß√µes de pre√ßos (opcional: criar tabela de auditoria)
1.3 Vincular Fornecedor a Tabela de Pre√ßo
Objetivo: Cada fornecedor est√° vinculado a UMA tabela de pre√ßo (padr√£o: 1‚òÖ)

Modificar tabela fornecedores:

Adicionar coluna: tabela_preco_id (FK ‚Üí tabelas_preco, default: 1)
Adicionar coluna: comprador_responsavel_id (FK ‚Üí usuarios, nullable)
Regras:

Fornecedores novos sempre iniciam com Tabela 1‚òÖ
Apenas ADM pode alterar a tabela vinculada
Mudan√ßa de tabela gera log de auditoria
1.4 Criar Tabela de Solicita√ß√µes de Autoriza√ß√£o de Pre√ßo
Objetivo: Quando comprador negocia pre√ßo acima da tabela, gera solicita√ß√£o para ADM

Estrutura da tabela solicitacoes_autorizacao_preco:

id (PK)
compra_id (FK ‚Üí compras, nullable inicialmente)
fornecedor_id (FK ‚Üí fornecedores)
comprador_id (FK ‚Üí usuarios)
material_id (FK ‚Üí materiais_base)
peso_kg (DECIMAL)
tabela_atual_id (FK ‚Üí tabelas_preco)
preco_tabela (DECIMAL - snapshot do pre√ßo da tabela)
preco_negociado (DECIMAL - o que o comprador quer)
justificativa (TEXT)
status (ENUM: 'pendente', 'aprovada', 'rejeitada')
decisao_adm_id (FK ‚Üí usuarios, nullable)
nova_tabela_atribuida_id (FK ‚Üí tabelas_preco, nullable)
motivo_decisao (TEXT)
data_solicitacao
data_decisao
Regras:

Comprador N√ÉO pode finalizar compra se houver itens pendentes de autoriza√ß√£o
ADM ao aprovar pode:
Apenas autorizar aquela compra espec√≠fica (tabela do fornecedor n√£o muda)
OU promover o fornecedor para tabela superior (2‚òÖ ou 3‚òÖ)
üìã ETAPA 2: IMPLEMENTAR CRUD DE MATERIAIS BASE
2.1 Backend - Rotas de Materiais Base
Criar arquivo: app/routes/materiais_base.py

Endpoints necess√°rios:

GET /api/materiais-base - Listar todos (com filtros: busca, classifica√ß√£o, ativo)
GET /api/materiais-base/{id} - Obter detalhes de um material
POST /api/materiais-base - Criar novo material (apenas ADM)
PUT /api/materiais-base/{id} - Atualizar material (apenas ADM)
DELETE /api/materiais-base/{id} - Desativar material (apenas ADM)
POST /api/materiais-base/importar-excel - Importar materiais via Excel (apenas ADM)
GET /api/materiais-base/exportar-excel - Exportar para Excel (apenas ADM)
GET /api/materiais-base/modelo-importacao - Baixar modelo de Excel
Regras de valida√ß√£o:

Nome √© obrigat√≥rio e √∫nico
Classifica√ß√£o deve ser 'leve', 'medio' ou 'pesado'
C√≥digo √© gerado automaticamente se n√£o fornecido
N√£o permitir deletar se houver compras vinculadas
2.2 Importa√ß√£o via Excel - Especifica√ß√£o Detalhada
Estrutura do arquivo Excel de importa√ß√£o:

Aba 1: "Materiais"

Coluna A: Nome (obrigat√≥rio)	Coluna B: Classifica√ß√£o (obrigat√≥rio)	Coluna C: Descri√ß√£o (opcional)
SUCATA PROCESSADOR CER√ÇMICO A	pesado	Processadores cer√¢micos tipo A
SUCATA PLACA M√ÉE SERVIDOR	pesado	Placas m√£e de servidores
...	...	...
L√≥gica de importa√ß√£o:

Validar estrutura do arquivo (colunas obrigat√≥rias presentes)
Para cada linha:
Verificar se material j√° existe pelo nome
Se existe: atualizar classifica√ß√£o e descri√ß√£o
Se n√£o existe: criar novo material com c√≥digo auto-gerado
Retornar relat√≥rio:
Materiais criados: X
Materiais atualizados: Y
Erros: [lista de erros com n√∫mero da linha]
Valida√ß√µes por linha:

Nome n√£o pode estar vazio
Classifica√ß√£o deve ser: leve, medio ou pesado (case-insensitive)
Nome n√£o pode exceder 200 caracteres
üìã ETAPA 3: IMPLEMENTAR CRUD DE TABELAS DE PRE√áO
3.1 Backend - Rotas de Tabelas de Pre√ßo
Criar arquivo: app/routes/tabelas_preco.py

Endpoints necess√°rios:

GET /api/tabelas-preco - Listar todas (1‚òÖ, 2‚òÖ, 3‚òÖ)
GET /api/tabelas-preco/{id} - Detalhes de uma tabela
GET /api/tabelas-preco/{id}/precos - Listar todos os pre√ßos da tabela (por material)
PUT /api/tabelas-preco/{id}/precos - Atualizar pre√ßos em massa (apenas ADM)
PUT /api/tabelas-preco/{id}/precos/{material_id} - Atualizar pre√ßo individual (apenas ADM)
POST /api/tabelas-preco/{id}/importar-precos-excel - Importar pre√ßos via Excel
GET /api/tabelas-preco/{id}/exportar-precos-excel - Exportar pre√ßos
Regras:

As 3 tabelas (1‚òÖ, 2‚òÖ, 3‚òÖ) s√£o criadas automaticamente na inicializa√ß√£o do sistema
N√£o permitir deletar tabelas
Ao criar novo material, automaticamente criar 3 registros em tabela_preco_itens (um para cada tabela, com pre√ßo 0.00)
3.2 Importa√ß√£o de Pre√ßos via Excel
Estrutura do arquivo Excel:

Formato 1 - Por Tabela (3 arquivos separados):

Aba: "Pre√ßos Tabela 1 Estrela"
| Material | Pre√ßo/kg (R$) |
|----------|---------------|
| SUCATA PROCESSADOR CER√ÇMICO A | 12.50 |
| SUCATA PLACA M√ÉE SERVIDOR | 8.30 |
Formato 2 - Consolidado (1 arquivo, melhor op√ß√£o):

Aba: "Tabela de Pre√ßos"
| Material | 1 Estrela (R$/kg) | 2 Estrelas (R$/kg) | 3 Estrelas (R$/kg) |
|----------|-------------------|--------------------|--------------------|
| SUCATA PROCESSADOR CER√ÇMICO A | 12.50 | 15.00 | 18.50 |
| SUCATA PLACA M√ÉE SERVIDOR | 8.30 | 10.00 | 12.00 |
L√≥gica de importa√ß√£o:

Buscar material pelo nome
Se material n√£o existe, IGNORAR linha e registrar no relat√≥rio de erros
Se material existe, atualizar pre√ßos nas 3 tabelas
Validar: pre√ßo deve ser >= 0
Retornar relat√≥rio com total de pre√ßos atualizados e erros
üìã ETAPA 4: REFORMULAR TELA /tipos-lote.html
4.1 Renomear e Redirecionar
A√ß√£o:

Renomear: /tipos-lote.html ‚Üí /materiais-base.html
Ou manter nome mas alterar t√≠tulo e conte√∫do
Atualizar menu de navega√ß√£o
4.2 Nova Interface da Tela de Materiais Base
Componentes principais:

Cabe√ßalho:

T√≠tulo: "Gest√£o de Materiais Base"
Bot√µes:
[+ Novo Material] (apenas ADM)
[üì• Importar Excel] (apenas ADM)
[üì§ Exportar Excel] (apenas ADM)
[üìã Baixar Modelo] (todos)
Filtros:

Busca por nome
Filtro por classifica√ß√£o (Todos / Leve / M√©dio / Pesado)
Filtro por status (Ativos / Inativos / Todos)
Tabela principal:

C√≥digo	Nome	Classifica√ß√£o	Pre√ßo 1‚òÖ	Pre√ßo 2‚òÖ	Pre√ßo 3‚òÖ	Ativo	A√ß√µes
MAT001	SUCATA PROC...	Pesado	R$ 12,50	R$ 15,00	R$ 18,50	‚úì	[Editar] [Ver]
Modal "Novo Material":

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Novo Material                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Nome: [________________]         ‚îÇ
‚îÇ C√≥digo: [____] (auto)            ‚îÇ
‚îÇ Classifica√ß√£o:                   ‚îÇ
‚îÇ   ( ) Leve                       ‚îÇ
‚îÇ   (‚Ä¢) M√©dio                      ‚îÇ
‚îÇ   ( ) Pesado                     ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ Descri√ß√£o:                       ‚îÇ
‚îÇ [_________________________]      ‚îÇ
‚îÇ [_________________________]      ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ ‚îå‚îÄ Pre√ßos Iniciais ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ ‚îÇ Tabela 1‚òÖ: R$ [____]      ‚îÇ   ‚îÇ
‚îÇ ‚îÇ Tabela 2‚òÖ: R$ [____]      ‚îÇ   ‚îÇ
‚îÇ ‚îÇ Tabela 3‚òÖ: R$ [____]      ‚îÇ   ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ [Cancelar] [Salvar]              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
üìã ETAPA 5: CRIAR TELA DE GEST√ÉO DE TABELAS DE PRE√áO
5.1 Nova Tela: /tabelas-preco.html (apenas ADM)
Layout principal:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Gest√£o de Tabelas de Pre√ßo                          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ [Tabela 1‚òÖ] [Tabela 2‚òÖ] [Tabela 3‚òÖ] (Abas)         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                      ‚îÇ
‚îÇ Filtros: [Buscar material...] [Classifica√ß√£o: ‚ñº]   ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ [üì• Importar Pre√ßos Excel] [üì§ Exportar]            ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ ‚îÇ Material                    ‚îÇ R$/kg ‚îÇ A√ß√µes  ‚îÇ  ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îÇ
‚îÇ ‚îÇ SUCATA PROC. CER√ÇMICO A     ‚îÇ 12.50 ‚îÇ [Edit] ‚îÇ  ‚îÇ
‚îÇ ‚îÇ SUCATA PLACA M√ÉE SERVIDOR   ‚îÇ  8.30 ‚îÇ [Edit] ‚îÇ  ‚îÇ
‚îÇ ‚îÇ SUCATA PROCESSADOR SLOT     ‚îÇ 15.00 ‚îÇ [Edit] ‚îÇ  ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ Total de materiais: 45                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
Funcionalidades:

Edi√ß√£o inline: Clicar no pre√ßo e editar diretamente
Edi√ß√£o em massa: Importar Excel com todos os pre√ßos
Exporta√ß√£o: Gerar Excel com pre√ßos atuais
Hist√≥rico: Bot√£o para ver hist√≥rico de altera√ß√µes de cada pre√ßo
üìã ETAPA 6: INTEGRAR FLUXO DE COMPRA COM MATERIAIS BASE
6.1 Modificar Fluxo de Nova Compra
Tela: Wizard de Nova Compra - Passo 3 (Leitura de Materiais)

Mudan√ßas necess√°rias:

Op√ß√£o 1 - Scanner de Materiais:

Comprador escaneia c√≥digo de barras
Sistema busca material na tabela materiais_base
Mostra: nome, classifica√ß√£o
Comprador informa: peso (kg)
Sistema busca pre√ßo na tabela vinculada ao fornecedor
Op√ß√£o 2 - Sele√ß√£o Manual:

Dropdown com lista de materiais (com busca)
Filtro por classifica√ß√£o
Comprador seleciona material
Comprador informa peso
Sistema calcula valor automaticamente
Interface do Passo 3:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Adicionar Materiais √† Compra               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                            ‚îÇ
‚îÇ [üîç Escanear] ou [‚ûï Adicionar Manual]    ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ ‚îå‚îÄ Materiais Adicionados ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ ‚îÇ Material          ‚îÇ Kg ‚îÇ R$/kg ‚îÇ Total‚îÇ  ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îÇ
‚îÇ ‚îÇ PROC CER√ÇMICO A   ‚îÇ 5  ‚îÇ 12.50 ‚îÇ62.50‚îÇ  ‚îÇ
‚îÇ ‚îÇ PLACA M√ÉE SERV    ‚îÇ 3  ‚îÇ  8.30 ‚îÇ24.90‚îÇ  ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ Peso Total: 8 kg                           ‚îÇ
‚îÇ Valor Total: R$ 87,40                      ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ [Voltar] [Continuar]                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
6.2 Valida√ß√£o de Pre√ßo Negociado
No Passo 4 do Wizard:

Cen√°rio A - Pre√ßo Dentro da Tabela:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚úÖ Pre√ßo dentro da tabela vigente          ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ Tabela atual do fornecedor: 1 Estrela     ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ Material: PROC CER√ÇMICO A                  ‚îÇ
‚îÇ Pre√ßo tabela: R$ 12,50/kg                  ‚îÇ
‚îÇ Pre√ßo negociado: R$ 12,00/kg               ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ Status: APROVADO AUTOMATICAMENTE           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
Cen√°rio B - Pre√ßo Acima da Tabela:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚ö†Ô∏è Pre√ßo acima da tabela vigente           ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ Tabela atual do fornecedor: 1 Estrela     ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ Material: PROC CER√ÇMICO A                  ‚îÇ
‚îÇ Pre√ßo tabela: R$ 12,50/kg                  ‚îÇ
‚îÇ Pre√ßo negociado: R$ 15,00/kg               ‚îÇ
‚îÇ Diferen√ßa: +R$ 2,50/kg (+20%)              ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ Justificativa (obrigat√≥ria):               ‚îÇ
‚îÇ [________________________________]         ‚îÇ
‚îÇ [________________________________]         ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ Status: AGUARDANDO APROVA√á√ÉO DO ADM        ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ [Enviar para Aprova√ß√£o]                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
üìã ETAPA 7: CRIAR TELA DE AUTORIZA√á√ïES DE PRE√áO (ADM)
7.1 Nova Tela: /autorizacoes-preco.html
Acesso: Apenas Administradores

Layout:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Autoriza√ß√µes de Pre√ßo Pendentes                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                      ‚îÇ
‚îÇ [Pendentes: 3] [Aprovadas] [Rejeitadas]             ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ ‚îÇ üìã Solicita√ß√£o #1245                         ‚îÇ   ‚îÇ
‚îÇ ‚îÇ Data: 17/11/2025 14:32                       ‚îÇ   ‚îÇ
‚îÇ ‚îÇ                                              ‚îÇ   ‚îÇ
‚îÇ ‚îÇ Comprador: Jo√£o Silva                        ‚îÇ   ‚îÇ
‚îÇ ‚îÇ Fornecedor: Eletr√¥nicos ABC (Tabela 1‚òÖ)      ‚îÇ   ‚îÇ
‚îÇ ‚îÇ                                              ‚îÇ   ‚îÇ
‚îÇ ‚îÇ Material: PROC CER√ÇMICO A                    ‚îÇ   ‚îÇ
‚îÇ ‚îÇ Peso: 5 kg                                   ‚îÇ   ‚îÇ
‚îÇ ‚îÇ                                              ‚îÇ   ‚îÇ
‚îÇ ‚îÇ Pre√ßo Tabela 1‚òÖ: R$ 12,50/kg                ‚îÇ   ‚îÇ
‚îÇ ‚îÇ Pre√ßo Negociado: R$ 15,00/kg                 ‚îÇ   ‚îÇ
‚îÇ ‚îÇ Diferen√ßa: +R$ 2,50/kg (+20%)                ‚îÇ   ‚îÇ
‚îÇ ‚îÇ                                              ‚îÇ   ‚îÇ
‚îÇ ‚îÇ Justificativa:                               ‚îÇ   ‚îÇ
‚îÇ ‚îÇ "Material de alt√≠ssima qualidade, placas    ‚îÇ   ‚îÇ
‚îÇ ‚îÇ  em estado impec√°vel, fornecedor confi√°vel" ‚îÇ   ‚îÇ
‚îÇ ‚îÇ                                              ‚îÇ   ‚îÇ
‚îÇ ‚îÇ [‚ùå Rejeitar] [‚úÖ Aprovar]                   ‚îÇ   ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
Modal de Aprova√ß√£o:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Aprovar Solicita√ß√£o #1245               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                        ‚îÇ
‚îÇ ( ) Aprovar apenas esta compra         ‚îÇ
‚îÇ     (fornecedor continua na Tabela 1‚òÖ) ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ (‚Ä¢) Aprovar e PROMOVER fornecedor      ‚îÇ
‚îÇ     para:                              ‚îÇ
‚îÇ     ( ) Tabela 2‚òÖ                      ‚îÇ
‚îÇ     (‚Ä¢) Tabela 3‚òÖ                      ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ Observa√ß√µes:                           ‚îÇ
‚îÇ [_______________________________]      ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ [Cancelar] [Confirmar Aprova√ß√£o]       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
üìã ETAPA 8: POPULAR DADOS INICIAIS
8.1 Script de Seed para Materiais Base
Criar arquivo: seed_materiais_base.py

Deve cadastrar os 45+ materiais da lista fornecida:

materiais = [
    {"nome": "SUCATA PROCESSADOR CER√ÇMICO A", "classificacao": "pesado"},
    {"nome": "SUCATA PROCESSADOR CER√ÇMICO B", "classificacao": "pesado"},
    {"nome": "SUCATA PROCESSADOR CER√ÇMICO C", "classificacao": "pesado"},
    {"nome": "SUCATA PROCESSADOR SLOT", "classificacao": "pesado"},
    {"nome": "SUCATA PROCESSADOR PL√ÅSTICO A", "classificacao": "leve"},
    # ... continuar com todos os 45+ materiais da imagem
]
8.2 Script para Criar Tabelas de Pre√ßo
Deve:

Criar 3 tabelas: "Tabela 1 Estrela", "Tabela 2 Estrelas", "Tabela 3 Estrelas"
Para cada material, criar pre√ßo inicial (pode ser 0.00 ou valor padr√£o)
Exemplo:
PROC CER√ÇMICO A: 1‚òÖ = R$12,50 | 2‚òÖ = R$15,00 | 3‚òÖ = R$18,50
üìã ETAPA 9: ATUALIZAR MENU DE NAVEGA√á√ÉO
9.1 Adicionar ao Menu do ADM
Menu "Administra√ß√£o" deve incluir:

Materiais Base (link: /materiais-base.html)
Tabelas de Pre√ßo (link: /tabelas-preco.html)
Autoriza√ß√µes de Pre√ßo (link: /autorizacoes-preco.html) - Badge com contador
9.2 Adicionar ao Menu do Comprador
Menu "Compras" deve incluir:

Nova Compra
Minhas Compras
Meus Fornecedores
(n√£o v√™ tabelas de pre√ßo nem autoriza√ß√µes)
üìã ETAPA 10: TESTES E VALIDA√á√ïES
10.1 Cen√°rios de Teste Obrigat√≥rios
Importar Excel de materiais com 10 itens novos
Importar Excel de pre√ßos para as 3 tabelas
Criar compra com material abaixo do pre√ßo da tabela (deve aprovar automaticamente)
Criar compra com material acima do pre√ßo da tabela (deve gerar solicita√ß√£o)
ADM aprovar solicita√ß√£o mantendo tabela do fornecedor
ADM aprovar solicita√ß√£o promovendo fornecedor para 2‚òÖ
Editar pre√ßo na tabela e verificar que afeta pr√≥ximas compras
üé® ETAPA 11: MELHORIAS DE UX/UI
11.1 Indicadores Visuais
Badge verde (‚úì) quando pre√ßo est√° dentro da tabela
Badge laranja (‚ö†) quando est√° acima mas pr√≥ximo (at√© 10%)
Badge vermelho (!) quando est√° muito acima (>10%)
11.2 Notifica√ß√µes
ADM recebe notifica√ß√£o quando h√° nova solicita√ß√£o de pre√ßo
Comprador recebe notifica√ß√£o quando sua solicita√ß√£o √© aprovada/rejeitada
11.3 Dashboards
Para Comprador:
Total comprado no m√™s
Solicita√ß√µes pendentes
Para ADM:
Solicita√ß√µes pendentes (contador)
Materiais sem pre√ßo configurado
Fornecedores por tabela (quantos em 1‚òÖ, 2‚òÖ, 3‚òÖ)
‚úÖ CHECKLIST FINAL DE IMPLEMENTA√á√ÉO
[ ] Tabela materiais_base criada e migrada
[ ] Tabela tabelas_preco criada
[ ] Tabela tabela_preco_itens criada
[ ] Tabela solicitacoes_autorizacao_preco criada
[ ] Coluna tabela_preco_id adicionada em fornecedores
[ ] CRUD de materiais base funcionando
[ ] Importa√ß√£o Excel de materiais funcionando
[ ] Exporta√ß√£o Excel de materiais funcionando
[ ] CRUD de tabelas de pre√ßo funcionando
[ ] Importa√ß√£o Excel de pre√ßos funcionando
[ ] Tela /materiais-base.html reformulada
[ ] Tela /tabelas-preco.html criada
[ ] Tela /autorizacoes-preco.html criada
[ ] Fluxo de compra integrado com materiais base
[ ] Valida√ß√£o de pre√ßo negociado vs tabela
[ ] Gera√ß√£o de solicita√ß√£o quando pre√ßo > tabela
[ ] ADM pode aprovar/rejeitar solicita√ß√µes
[ ] ADM pode promover fornecedor de tabela
[ ] Seed de 45+ materiais executado
[ ] Seed de 3 tabelas de pre√ßo executado
[ ] Menus atualizados (ADM e Comprador)
[ ] Notifica√ß√µes funcionando
[ ] Testes realizados e aprovados
üìù OBSERVA√á√ïES IMPORTANTES
Manter Compatibilidade: N√£o quebrar funcionalidades existentes de solicita√ß√µes e lotes
RBAC: Respeitar permiss√µes (Comprador N√ÉO v√™/edita pre√ßos)
Auditoria: Registrar todas as altera√ß√µes de pre√ßos e promo√ß√µes de fornecedores
Performance: √çndices nas tabelas para buscas r√°pidas
Valida√ß√µes: Frontend E backend devem validar dados