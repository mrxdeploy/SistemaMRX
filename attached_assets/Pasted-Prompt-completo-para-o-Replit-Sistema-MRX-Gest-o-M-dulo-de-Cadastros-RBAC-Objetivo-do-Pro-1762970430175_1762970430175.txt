Prompt completo para o Replit â€“ Sistema MRX_GestÃ£o (MÃ³dulo de Cadastros + RBAC)
ğŸ¯ **Objetivo do Prompt**
Gerar um sistema completo em Python (FastAPI) + React (frontend) que implemente o mÃ³dulo de **cadastros base e controle de acesso (RBAC)** do sistema **MRX_GestÃ£o**, conforme o blueprint oficial.

---

## âš™ï¸ Contexto Geral

O sistema MRX_GestÃ£o Ã© responsÃ¡vel por gerenciar toda a operaÃ§Ã£o logÃ­stica e comercial da MRX do Brasil â€” uma empresa especializada em compra, separaÃ§Ã£o, conferÃªncia, estoque e faturamento de resÃ­duos eletrÃ´nicos.

Este mÃ³dulo corresponde Ã  **Fase 1 â€“ Cadastros Base e Controle de Acesso**.

---

## ğŸ§© Escopo deste prompt

### 1ï¸âƒ£ Implementar **cadastros base**:
- UsuÃ¡rios  
- Perfis (roles)  
- Fornecedores  
- Produtos (Materiais)  
- VeÃ­culos  
- Motoristas  

Cada cadastro deve ter:
- CRUD completo (criar, listar, editar, excluir)  
- ValidaÃ§Ã£o de campos (ex: CNPJ, CPF, e-mail, duplicidade)  
- Registro de data de criaÃ§Ã£o e usuÃ¡rio que criou  
- Logs de alteraÃ§Ãµes para auditoria futura  

---

### 2ï¸âƒ£ Implementar **controle de acesso (RBAC)** com os perfis descritos:

| Perfil | DescriÃ§Ã£o / PermissÃµes |
|--------|-------------------------|
| **Administrador** | Acesso total; define limites; aprova exceÃ§Ãµes; autoriza descarte; fecha inventÃ¡rio; gerencia usuÃ¡rios e perfis. |
| **Comprador (PJ)** | Abre solicitaÃ§Ãµes de compra, cadastra fornecedores, informa entregas/coletas e registra preÃ§o pago. |
| **Conferente / Estoque** | Valida chegada, pesa, confere itens e qualidade; cria lotes e dÃ¡ entrada no estoque. |
| **SeparaÃ§Ã£o** | Separa lotes por material/condiÃ§Ã£o; gera sublotes e resÃ­duos para descarte (com aprovaÃ§Ã£o ADM). |
| **Motorista** | Recebe rotas, realiza coletas e envia comprovantes/fotos. |
| **Financeiro** | Emite notas, controla pagamentos e conciliaÃ§Ã£o bancÃ¡ria. |
| **Auditoria / BI** | Acesso apenas leitura aos painÃ©is e trilhas de auditoria. |

---

## ğŸ§± Requisitos tÃ©cnicos

- **Backend:** FastAPI + SQLAlchemy + PostgreSQL  
- **Frontend:** React + Tailwind + Axios  
- **AutenticaÃ§Ã£o:** JWT + Refresh Token  
- **AutorizaÃ§Ã£o:** Middleware RBAC (baseado no campo `perfil`)  
- **Banco:** PostgreSQL  
- **ValidaÃ§Ã£o:** Pydantic (CPF/CNPJ/email Ãºnicos)  
- **Auditoria:** Registrar IP, device e timestamp em cada aÃ§Ã£o crÃ­tica  

---

## ğŸ§® Estrutura de entidades (modelo inicial)

### ğŸ”¹ UsuÃ¡rio
```python
id, nome, email, senha_hash, perfil_id, ativo, criado_em, criado_por

ğŸ”¹ Perfil (Role)
id, nome (Administrador, Comprador, etc), descricao, permissoes (lista JSON)

ğŸ”¹ Fornecedor
id, nome, cnpj, endereco_coleta, endereco_emissao, contato, banco, agencia, conta, pix, criado_por

ğŸ”¹ Produto (Material)
id, nome, categoria, unidade, ativo

ğŸ”¹ VeÃ­culo
id, placa, renavam, tipo, capacidade

ğŸ”¹ Motorista
id, nome, cpf, telefone, veiculo_id (FK), ativo

ğŸ”’ Regras de acesso (RBAC)

Apenas Administrador pode criar/editar usuÃ¡rios e perfis.

Comprador pode criar fornecedores.

Conferente e SeparaÃ§Ã£o nÃ£o podem criar fornecedores.

Motorista sÃ³ pode acessar suas prÃ³prias rotas e dados pessoais.

Financeiro tem acesso apenas a mÃ³dulos de faturamento/pagamento.

Auditoria/BI possui acesso leitura total e bloqueio de ediÃ§Ã£o.

ğŸ§­ Requisitos funcionais adicionais

 Tela de login (email + senha)

 Tela de listagem de usuÃ¡rios com filtro por perfil

 Tela de cadastro de fornecedor

 Tela de cadastro de produto/material

 Tela de cadastro de veÃ­culo e motorista (com vÃ­nculo entre ambos)

 Painel de administraÃ§Ã£o para gerenciar perfis e permissÃµes

 Endpoint /me para retornar dados do usuÃ¡rio logado

 Endpoint /auditoria para registrar logs

ğŸ§© EntregÃ¡veis esperados

âœ… CRUD funcional para todas as entidades base.
âœ… Middleware RBAC ativo com permissÃµes corretas.
âœ… Login com JWT + refresh token.
âœ… ValidaÃ§Ãµes de campos e mensagens de erro amigÃ¡veis.
âœ… Interface React responsiva com formulÃ¡rios e tabelas.